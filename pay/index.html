<!doctype html>
<html class=" js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths"><head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width initial-scale=1">
	<title>Install Payment / NYC Mesh</title>
	<meta name="description" content="a better network">
	<link href="/mesh.ico" rel="shortcut icon" type="image/x-icon">
  <link rel="stylesheet" href="/css/tachyons.min.css"/>
	<link rel="stylesheet" href="/css/donatestyle.css">
	<link rel="stylesheet" href="/css/main2.css">
	<link rel="canonical" href="http://nycmeshnet.github.io/faq/">
	<link rel="alternate" type="application/atom+xml" title="NYC Mesh" href="http://nycmeshnet.github.io/feed.xml">
	<!--   <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.js'></script>
  <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-heat/v0.1.0/leaflet-heat.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.css' rel='stylesheet' />
   -->
<style>[href^="http://www.amazon.co.uk/exec/obidos/external-search?"],
[href^="http://twitter.com/?status="],
[href^="http://twitter.com/home/?"],
[href^="http://twitter.com/home?"],
[href^="http://twitter.com/intent/tweet/?url="],
[href^="http://twitter.com/intent/tweet?"],
[href^="http://twitter.com/share?"],
[href^="https://twitter.com/intent/follow?"],
[href^="https://twitter.com/intent/retweet?tweet_id"],
[href^="https://twitter.com/intent/tweet?"],
[href^="https://twitter.com/share?"],
.container > .infoBoxList > .shareInfoBox
{display:none !important;}
.w2 { width: 50px }</style></head>

<body class="blog bg-near-white ">
  <div id="donatemap">
	<img src="/assets/images/banner.jpg" alt="banner" width="1500" height="500">
</div>
<nav>
  <a href="/" class="logo">
    <img src="/assets/images/logo.png">
    NYC Mesh
  </a>
  <div class="mainnav">

    <a href="/map">Map</a>
    <a href="/blog">Blog</a>
    <a href="/faq">FAQ</a>
    <a href="/join">Join</a>
    <a href="/donate">Donate</a>
	<div></div>

  </div>

  <div class="title-container">
    <div class="donatetitle">

    <div class="tags">

    </div>

    <h1>Install Payment</h1> 
    Thank you for installing a mesh node!
    <p class="sig">
    <!-- <img src="http://nycmeshnet.github.io/images/" alt=" photo">  -->

    </p>

</div>

  </div>
</nav>

<!-- Stripe Donation -->
<div id="donation-amounts" class="dt w-100 mw8 f3 center pv4 ph3 f4">
  <p class="bb pb4 tl">The NYC Mesh home install costs $160, $50 to be paid to the installer and $110 to be paid below for parts and equipment. The total of $160 per apartment is due on completion.</p>
  <div class="flex flex-row justify-between">
    <p class="pv4 nowrap">Parts and equipment</p>
    <div class="w-100 h2 bw1 bb bt-0 bl-0 br-0 b--dotted"></div>
    <p class="pv4">$</p><input id="custom" onfocus="setAmount('custom')" type"number" maxlength="7" name="donation-amount" value="110" class="bn ph0 w4 overflow-visible" >
  </div>
  <div class="tl">
    <form>
      <p>Please also subscribe me to a monthly donation (starting next month)</p>
      <div>
        <div>
          <input class="w1" type="radio" id="twenty-monthly"
           name="contact" value="email" checked="checked" onclick="setSubscription('twenty-monthly')">
          <label class="fw4" for="twenty-monthly">$20</label>
        </div>

        <div>
          <input class="w1" type="radio" id="fifty-monthly"
           name="contact" value="phone" onclick="setSubscription('fifty-monthly')">
          <label class="fw4" for="fifty-monthly">$50</label>
        </div>

        <div>
          <input class="w1" type="radio" id="hundred-monthly"
           name="contact" value="mail" onclick="setSubscription('hundred-monthly')">
          <label class="fw4" for="hundred-monthly">$100 (business)</label>
        </div>

        <div>
          <input class="w1" type="radio" id="no-monthly"
           name="contact" value="mail" onclick="setSubscription(undefined)">
          <label class="fw4" for="no-monthly">I do not wish to donate</label>
        </div>
      </div>
    </form>
  </div>

  <div class="flex flex-row justify-end w-100 mb5">
  <div  class="pt4 mt4 mw5 w-100 f4 self-end">
    <input id="payButton" type="submit" value="Pay with card" class="input-reset bw0 w-100 fw5 br3 pa3 sans-serif white">
    </input>
  </div>
</div>


  <footer class="footer">
	<a href="/">Home</a>
  <div class="mainnav">

    <a href="/map">Map</a>
    <a href="/blog">Blog</a>
    <a href="/faq">FAQ</a>
    <a href="/join">Join</a>
    <a href="/donate">Donate</a>
	<div></div>

  </div>

</footer>

</div>
  <script async="" src="//www.google-analytics.com/analytics.js"></script><script src="/assets/javascript/modernizr.js"></script>
<script src="/assets/javascript/jquery-1.11.0.min.js"></script>
<script src="/assets/javascript/bootstrap.js"></script>
<script src="/assets/javascript/scripts.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-56517898-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- handle form input -->
  <script>
    var defaultDonation = 110
    var defaultSubscription = 'twenty-monthly'

    // Get donation and sub from url
    var url_string = window.location.href
    var url = new URL(url_string);
    var URLamount = url.searchParams.get("a");
    var donationAmount = URLamount * 100 || defaultDonation * 100
    
    var subscriptionPlan = defaultSubscription
    var plan = url.searchParams.get("s");
    if (plan == 20) {
      let planId = 'twenty-monthly'
      document.getElementById(planId).checked = "checked"
      setSubscription(planId)
    }
    if (plan == 50) {
      let planId = 'fifty-monthly'
      document.getElementById(planId).checked = "checked"
      setSubscription(planId)
    }
    if (plan == 100) {
      let planId = 'hundred-monthly'
      document.getElementById(planId).checked = "checked"
      setSubscription(planId)
    }
    if (plan == 'none' || plan == 0) {
      let planId = 'no-monthly'
      document.getElementById(planId).checked = "checked"
      setSubscription(undefined)
    }

    var donationType, customAmount;
    var customDonation = document.getElementById('custom');
    customDonation.value = donationAmount / 100

    customDonation.onkeypress = function(e) {
      // not a number
      if (e.which < 48 || e.which > 57)
        e.preventDefault()
    }

    customDonation.addEventListener('input', function(e) {
      var dollars = e.target.value;
      donationAmount = dollars*100;
      customAmount = dollars*100;
    })

    customDonation.addEventListener('focus', function(e) {
      var tmpStr = e.target.value;
      e.target.value = '';
      e.target.value = tmpStr;
      donationAmount = customAmount;
    })

    function setSubscription(plan) {
      subscriptionPlan = plan;
    }

    function setAmount(amount) {
      // deselect selected
      var selected = document.getElementById(donationAmount) || document.getElementById('custom');

      // highlight choice and set amount
      var button = document.getElementById(amount);
      if (amount == 'custom') {
        donationAmount = customAmount;
      }
      else {
        button.className = 'dtc mh2 w4 br2 bg-dark-gray selected';
        donationAmount = amount;
      }
    }
  </script>

  <script src="https://checkout.stripe.com/checkout.js"></script>

  <script>

    function token(token) {
      var request = new XMLHttpRequest();

      request.onload = function() {
        if (request.status === 200) {
          window.location = '/pay/thanks'
        } else {
          window.location = '/pay/error'
        }
      }

      request.open('POST', 'https://donate2.nycmesh.net/charge', true);
      request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
      request.send(JSON.stringify({
        stripeToken: token,
        donationAmount: donationAmount,
        subscriptionPlan: subscriptionPlan
      }));
    }

    var stripeConfig = {
      key: 'pk_live_srTdi5OfErTSw5BGXqEkY9C1',
      image: 'https://nycmesh.net:/assets/images/logo.png',
      locale: 'auto',
      zipCode: true,
      token: token
    }

    var handler = StripeCheckout.configure(stripeConfig);

    var payButton = document.getElementById('payButton');
    payButton.addEventListener('click', function(e) {

      if (parseInt(donationAmount) && donationAmount > 0) {
        stripeConfig.bitcoin = true;
        handler = StripeCheckout.configure(stripeConfig);
        handler.open({
          name: 'NYC Mesh',
          description: 'Donation',
          amount: donationAmount
        });
      }

      else {
        alert('Please enter a valid donation amount.')
      }

      e.preventDefault();
    });

    // Close Checkout on page navigation:
    window.addEventListener('popstate', function() {
      handler.close();
    });
  </script>


</body></html>
